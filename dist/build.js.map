{"version":3,"names":[],"mappings":"","sources":["build.js"],"sourcesContent":["!function a(u,i,c){function s(t,e){if(!i[t]){if(!u[t]){var n=\"function\"==typeof require&&require;if(!e&&n)return n(t,!0);if(l)return l(t,!0);var r=new Error(\"Cannot find module '\"+t+\"'\");throw r.code=\"MODULE_NOT_FOUND\",r}var o=i[t]={exports:{}};u[t][0].call(o.exports,function(e){return s(u[t][1][e]||e)},o,o.exports,a,u,i,c)}return i[t].exports}for(var l=\"function\"==typeof require&&require,e=0;e<c.length;e++)s(c[e]);return s}({1:[function(e,t,n){\"use strict\";Object.defineProperty(n,\"__esModule\",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var o=function(){function u(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,u)}return r(u,null,[{key:\"fetchRestaurants\",value:function(t){fetch(u.DATABASE_URL+\"/restaurants\").then(function(e){return e.json()}).then(function(e){t(null,e)}).catch(function(e){t(\"Request failed. Returned status of \"+e,null)})}},{key:\"fetchRestaurantById\",value:function(e,n){fetch(u.DATABASE_URL+\"/restaurants/\"+e).then(function(e){return e.json()}).then(function(t){fetch(u.DATABASE_URL+\"/reviews/?restaurant_id=\"+e).then(function(e){return e.json()}).then(function(e){console.log(e),t.reviews=e,n(null,t)})}).catch(function(){n(\"Restaurant does not exist\",null)})}},{key:\"fetchRestaurantByCuisine\",value:function(r,o){u.fetchRestaurants(function(e,t){if(e)o(e,null);else{var n=t.filter(function(e){return e.cuisine_type==r});o(null,n)}})}},{key:\"fetchRestaurantByNeighborhood\",value:function(r,o){u.fetchRestaurants(function(e,t){if(e)o(e,null);else{var n=t.filter(function(e){return e.neighborhood==r});o(null,n)}})}},{key:\"fetchRestaurantByCuisineAndNeighborhood\",value:function(r,o,a){u.fetchRestaurants(function(e,t){if(e)a(e,null);else{var n=t;\"all\"!=r&&(n=n.filter(function(e){return e.cuisine_type==r})),\"all\"!=o&&(n=n.filter(function(e){return e.neighborhood==o})),a(null,n)}})}},{key:\"fetchNeighborhoods\",value:function(o){u.fetchRestaurants(function(e,n){if(e)o(e,null);else{var r=n.map(function(e,t){return n[t].neighborhood}),t=r.filter(function(e,t){return r.indexOf(e)==t});o(null,t)}})}},{key:\"fetchCuisines\",value:function(o){u.fetchRestaurants(function(e,n){if(e)o(e,null);else{var r=n.map(function(e,t){return n[t].cuisine_type}),t=r.filter(function(e,t){return r.indexOf(e)==t});o(null,t)}})}},{key:\"setRestaurantFavoriteIndicator\",value:function(e,t){return fetch(u.DATABASE_URL+\"/restaurants/\"+e+\"/?is_favorite=\"+t,{method:\"PUT\"}).then(function(e){return console.log(e),e.json()}).then(function(e){console.log(e,\"<- favorited\")}).catch(function(){callback(\"Restaurant does not exist\",null)})}},{key:\"postReviewOnRestaurant\",value:function(e,t){return fetch(u.DATABASE_URL+\"/reviews\",{method:\"POST\",body:JSON.stringify(e)}).then(function(e){return console.log(e),e.json()}).then(function(e){console.log(e,\"<- posted\")}).catch(function(){t(\"Review failed to save\",null)})}},{key:\"urlForRestaurant\",value:function(e){return\"./restaurant.html?id=\"+e.id}},{key:\"imageUrlForRestaurant\",value:function(e){return\"/dist/images/\"+e.photograph+\".webp\"}},{key:\"mapMarkerForRestaurant\",value:function(e,t){return new google.maps.Marker({position:e.latlng,title:e.name,url:u.urlForRestaurant(e),map:t,animation:google.maps.Animation.DROP})}},{key:\"DATABASE_URL\",get:function(){return\"http://localhost:1337\"}}]),u}();n.default=o},{}],2:[function(e,t,n){\"use strict\";var i=r(e(\"./dbhelper\"));function r(e){return e&&e.__esModule?e:{default:e}}var o=(0,r(e(\"lozad\")).default)(),a=40.722216,u=-73.987501,c={markers:[]},s=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:c.neighborhoods,n=document.getElementById(\"neighborhoods-select\");e.forEach(function(e){var t=document.createElement(\"option\");t.innerHTML=e,t.value=e,n.append(t),o.observe()})},l=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:c.cuisines,n=document.getElementById(\"cuisines-select\");e.forEach(function(e){var t=document.createElement(\"option\");t.innerHTML=e,t.value=e,n.append(t)})},f=function(){var e=document.getElementById(\"cuisines-select\"),t=document.getElementById(\"neighborhoods-select\"),n=e.selectedIndex,r=t.selectedIndex,o=e[n].value,a=t[r].value;i.default.fetchRestaurantByCuisineAndNeighborhood(o,a,function(e,t){e?console.error(e):(d(t),h())})},d=function(e){c.restaurants=[],document.getElementById(\"restaurants-list\").innerHTML=\"\",c.markers.forEach(function(e){return e.setMap(null)}),c.markers=[],c.restaurants=e},h=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:c.restaurants,t=document.getElementById(\"restaurants-list\");e.forEach(function(e){t.append(v(e))}),o.observe(),g()},v=function(e){var t=document.createElement(\"li\"),n=document.createElement(\"img\");n.className=\"restaurant-img lozad\",n.setAttribute(\"data-src\",i.default.imageUrlForRestaurant(e)),n.alt=\"Image of a restaurant called \"+e.name,t.append(n);var r=document.createElement(\"h2\");r.innerHTML=e.name,t.append(r);var o=document.createElement(\"p\");o.innerHTML=e.neighborhood,t.append(o);var a=document.createElement(\"p\");a.innerHTML=e.address,t.append(a);var u=document.createElement(\"a\");return u.innerHTML=\"View Details\",u.href=i.default.urlForRestaurant(e),t.append(u),t},g=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:c.restaurants;e.forEach(function(e){var t=i.default.mapMarkerForRestaurant(e,c.map);google.maps.event.addListener(t,\"click\",function(){window.location.href=t.url}),c.markers.push(t)});var t=e.map(function(e){return e.latlng});m(t)},m=function(e){console.log(e);var t=\"https://maps.googleapis.com/maps/api/staticmap?\\n  center=\"+a+\", \"+u+\"\\n  &zoom=12\\n  &size=2400x2400\\n  &maptype=roadmap\\n  \"+(e?e.map(function(e){return\"&markers=color:red%7C\"+e.lat+\",\"+e.lng}).join(\"\"):\"\")+\"\\n  &key=AIzaSyAXlOTPzwGrGLlSNT9IpeYO9oTzeFPZ7a0\",n=document.createElement(\"img\");n.src=t,n.style.height=\"100%\",n.style.width=\"100%\",n.style[\"object-fit\"]=\"cover\";var r=document.querySelector(\"#map\");r.innerHTML=\"\",r.appendChild(n)};window.initMap=function(){m(),f()},document.addEventListener(\"DOMContentLoaded\",function(e){window.updateRestaurants=f,navigator.serviceWorker&&navigator.serviceWorker.register(\"/build_sw.js\").then(function(e){navigator.serviceWorker.controller}),i.default.fetchNeighborhoods(function(e,t){e?console.error(e):(c.neighborhoods=t,s())}),i.default.fetchCuisines(function(e,t){e?console.error(e):(c.cuisines=t,l())}),o.observe()})},{\"./dbhelper\":1,lozad:3}],3:[function(e,t,n){var r,o;r=this,o=function(){\"use strict\";var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n=document.documentMode,f={rootMargin:\"0px\",threshold:0,load:function(e){if(\"picture\"===e.nodeName.toLowerCase()){var t=document.createElement(\"img\");n&&e.getAttribute(\"data-iesrc\")&&(t.src=e.getAttribute(\"data-iesrc\")),e.appendChild(t)}e.getAttribute(\"data-src\")&&(e.src=e.getAttribute(\"data-src\")),e.getAttribute(\"data-srcset\")&&(e.srcset=e.getAttribute(\"data-srcset\")),e.getAttribute(\"data-background-image\")&&(e.style.backgroundImage=\"url('\"+e.getAttribute(\"data-background-image\")+\"')\")},loaded:function(){}};function d(e){e.setAttribute(\"data-loaded\",!0)}var h=function(e){return\"true\"===e.getAttribute(\"data-loaded\")};return function(){var n,r,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:\".lozad\",e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=l({},f,e),a=t.rootMargin,u=t.threshold,i=t.load,c=t.loaded,s=void 0;return window.IntersectionObserver&&(s=new IntersectionObserver((n=i,r=c,function(e,t){e.forEach(function(e){0<e.intersectionRatio&&(t.unobserve(e.target),h(e.target)||(n(e.target),d(e.target),r(e.target)))})}),{rootMargin:a,threshold:u})),{observe:function(){for(var e,t=(e=o)instanceof Element?[e]:e instanceof NodeList?e:document.querySelectorAll(e),n=0;n<t.length;n++)h(t[n])||(s?s.observe(t[n]):(i(t[n]),d(t[n]),c(t[n])))},triggerLoad:function(e){h(e)||(i(e),d(e),c(e))}}}},\"object\"==typeof n&&void 0!==t?t.exports=o():\"function\"==typeof define&&define.amd?define(o):r.lozad=o()},{}]},{},[2]);"],"file":"build.js"}